<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>8 Análisis de la varianza. | R-Stars: La Guía</title>
<meta name="author" content="Miguel-Ángel Tarancón">
<meta name="description" content="8.1 Introducción. El análisis de la varianza (ANOVA) puede considerarse una generalización del contraste de hipótesis de medias poblacionales iguales para el caso de poblaciones normales y con...">
<meta name="generator" content="bookdown 0.42 with bs4_book()">
<meta property="og:title" content="8 Análisis de la varianza. | R-Stars: La Guía">
<meta property="og:type" content="book">
<meta property="og:url" content="https://teckel71.github.io/RStars-book/análisis-de-la-varianza..html">
<meta property="og:image" content="https://teckel71.github.io/RStars-book/figuras/Portada_v3-2.jpg">
<meta property="og:description" content="8.1 Introducción. El análisis de la varianza (ANOVA) puede considerarse una generalización del contraste de hipótesis de medias poblacionales iguales para el caso de poblaciones normales y con...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="8 Análisis de la varianza. | R-Stars: La Guía">
<meta name="twitter:description" content="8.1 Introducción. El análisis de la varianza (ANOVA) puede considerarse una generalización del contraste de hipótesis de medias poblacionales iguales para el caso de poblaciones normales y con...">
<meta name="twitter:image" content="https://teckel71.github.io/RStars-book/figuras/Portada_v3-2.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Inter-0.4.9/font.css" rel="stylesheet">
<link href="libs/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="libs/Inter_Tight-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="assets/styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R-Stars: La Guía</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li><a class="" href="prefacio.html">Prefacio</a></li>
<li><a class="" href="introducci%C3%B3n..html"><span class="header-section-number">1</span> Introducción.</a></li>
<li><a class="" href="almacenando-y-manipulando-datos..html"><span class="header-section-number">2</span> Almacenando y manipulando datos.</a></li>
<li><a class="" href="gr%C3%A1ficos..html"><span class="header-section-number">3</span> Gráficos.</a></li>
<li><a class="" href="estad%C3%ADstica-descriptiva..html"><span class="header-section-number">4</span> Estadística descriptiva.</a></li>
<li><a class="" href="an%C3%A1lisis-previo-de-datos..html"><span class="header-section-number">5</span> Análisis previo de datos.</a></li>
<li><a class="" href="componentes-principales..html"><span class="header-section-number">6</span> Componentes principales.</a></li>
<li><a class="" href="an%C3%A1lisis-cl%C3%BAster..html"><span class="header-section-number">7</span> Análisis Clúster.</a></li>
<li><a class="active" href="an%C3%A1lisis-de-la-varianza..html"><span class="header-section-number">8</span> Análisis de la varianza.</a></li>
<li><a class="" href="an%C3%A1lisis-de-regresi%C3%B3n-lineal-m%C3%BAltiple..html"><span class="header-section-number">9</span> Análisis de Regresión Lineal Múltiple.</a></li>
<li><a class="" href="an%C3%A1lisis-de-datos-cualitativos..html"><span class="header-section-number">10</span> Análisis de Datos Cualitativos.</a></li>
<li><a class="" href="bibliograf%C3%ADa.html">Bibliografía</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="análisis-de-la-varianza." class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Análisis de la varianza.<a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-de-la-varianza."><i class="fas fa-link"></i></a>
</h1>
<div id="introducción.-4" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Introducción.<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n.-4"><i class="fas fa-link"></i></a>
</h2>
<p>El análisis de la varianza (ANOVA) puede considerarse una generalización del contraste de hipótesis de medias poblacionales iguales para el caso de poblaciones normales y con varianzas desconocidas, pero iguales. La generalización consiste en poder considerar más de dos poblaciones. La <strong>hipótesis nula</strong> será la que afirma que <strong>las medias poblacionales de la variable métrica en estudio, para todas las poblaciones, son iguales</strong>. La hipótesis alternativa, por su lado, afirmará que existe al menos dos poblaciones con medias diferentes. Como todo contraste, para llevarlo acabo hemos de tener una muestra representativa de cada población, y fijar un nivel de significación (usualmente 0.05).</p>
<p>También se puede considerar el ANOVA como un <strong>tipo especial de análisis de regresión</strong>, en la que la variable dependiente es una variable métrica, y las variables explicativas son atributos o factores (en escala nominal u ordinal). La misión de los factores es clasificar a los casos que constituyen nuestra muestra en distintas submuestras, cada una representativa de una de las subpoblaciones cuyas medias en la variable en estudio se quiere comparar.</p>
</div>
<div id="anova-de-un-solo-factor." class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> ANOVA de un solo factor.<a class="anchor" aria-label="anchor" href="#anova-de-un-solo-factor."><i class="fas fa-link"></i></a>
</h2>
<p>Aunque se pueden realizar ANOVAs con más de un atributo o factor, en este ejemplo nos ceñiremos al caso más simple, en el que solo hay un atributo o factor que se ocupa de distribuir los casos de la muestra entre los distintos grupos o submuestras (a partir de las categoría o nivel que toma cada caso).</p>
<p>En concreto, en esta práctica, comprobaremos <strong>si</strong> <strong>la dimensión del grupo empresarial al que pertenecen las empresas eólicas</strong> (medida en función del número de empresas integradas en el grupo empresarial, y concretada en el factor DIMENSION) <strong>tiene una influencia significativa sobre la rentabilidad económica</strong> (variable RENECO), <strong>en términos medios</strong>. Para ello se ha seleccionado una muestra constituida por 50 empresas productoras de electricidad mediante tecnología eólica. Así, la población, constituida por todas las empresas de generación eléctrica eólica de España, queda dividida en tres subpoblaciones: la subpoblación de empresas que pertenecen a grupos empresariales de DIMENSION (según el número de filiales contenidas) “GRANDE”, la subpoblación de empresas que pertenecen a grupos empresariales de DIMENSION “MEDIA”, y la subpoblación de empresas que pertenecen a grupos empresariales de DIMENSION “PEQUEÑA”. Cada una de estas subpoblaciones tendrán sus respectivas rentabilidades económicas medias, que desconocemos (ya que no tenemos los datos de la población, es decir, de todas las empresas eólicas del país; sino solo de una muestra de 50 empresas). Lo que si tenemos para cada subpoblación es una submuestra que la representa (parte de las 50 empresas de la muestra, que queda fraccionada en tres según el factor DIMENSION). Y de cada submuestra, tenemos la correspondiente rentabilidad media muestral. Lo que comprobaremos con el contraste de ANOVA, en definitiva, es si las diferencias observadas entre las rentabilidades medias de cada submuestra son lo suficientemente amplias como para pensar que, puede considerarse que existen diferencias importantes (significativas) entre las rentabilidades medias de las subpoblaciones (considerando todas las empresas eólicas que conforman la población).</p>
<p>Los datos están almacenados en el archivo de Microsoft Excel “<a href="https://docs.google.com/spreadsheets/d/1PVRwLo1eAbFLOgSscLZw0bD9rgMk2X-w/edit?usp=sharing&amp;ouid=115375878280465826079&amp;rtpof=true&amp;sd=true">eolica_50.xls</a>”, y el script con el código del ejemplo se halla contenido en el fichero “<a href="https://drive.google.com/file/d/1p4p17OudRprwkpF7wvvF1gwHZG82uv89/view?usp=sharing">anova_cluster.R</a>”. Vamos a suponer que trabajaremos en un proyecto de RStudio al que denominaremos “anova”.</p>
<p>Una vez abierto el <em>script</em> en el editor de RStudio , comprobaremos que la primera parte del código está dedicada a la limpieza de la memoria (<em>Environment</em>) y a la importación de los datos. Para ello, activaremos el paquete <a href="https://readxl.tidyverse.org">readxl</a> y utilizaremos la función <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code>, indicando en los argumentos el archivo a explorar, y la <em>hoja</em> en la cual se encuentran los datos (hoja “Datos”). También hemos de prestar atención a la cuestión de si existen en la hoja de <em>Excel</em> anotaciones en las celdas donde no haya dato, para completar adecuadamente el argumento <code>na=</code> . Los datos se almacenarán en el <em>data frame</em> “datos”. En este <em>data frame</em>, la primera columna no es una verdadera variable, sino que se compone de los nombres de los casos o empresas. Con una línea de código adicional transformaremos esa primera columna en el <em>nombre de las filas</em>, de modo que tal columna abandona su <em>rol</em> de variable. En definitiva, el código para importar los datos es:</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Análisis ANOVA de un factor.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># DATOS</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"eolica_50.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>,</span>
<span>                    na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n.d."</span>, <span class="st">"s.d."</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">datos</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span> <span class="op">(</span><span class="va">datos</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       RES              ACTIVO            FPIOS        
##  Min.   :-5268.6   Min.   :  25355   Min.   : -10985  
##  1st Qu.:  919.6   1st Qu.:  35512   1st Qu.:   1897  
##  Median : 2321.2   Median :  50301   Median :  17256  
##  Mean   : 4986.7   Mean   : 189142   Mean   :  83164  
##  3rd Qu.: 4380.4   3rd Qu.: 101035   3rd Qu.:  44871  
##  Max.   :42737.0   Max.   :2002458   Max.   :1740487  
##                    NA's   :1                          
## 
##      RENECO           RENFIN            LIQUIDEZ       
##  Min.   :-2.708   Min.   :-263.639   Min.   :  0.0140  
##  1st Qu.: 1.817   1st Qu.:   1.251   1st Qu.:  0.6462  
##  Median : 3.957   Median :  14.322   Median :  1.1550  
##  Mean   : 5.758   Mean   :  32.071   Mean   :  4.2370  
##  3rd Qu.: 8.038   3rd Qu.:  36.193   3rd Qu.:  1.9185  
##  Max.   :35.262   Max.   : 588.190   Max.   :128.4330  
##  NA's   :2                                             
## 
##     ENDEUDA            MARGEN           SOLVENCIA      
##  Min.   :  0.917   Min.   :-2248.16   Min.   :-24.465  
##  1st Qu.: 37.272   1st Qu.:   14.74   1st Qu.:  4.327  
##  Median : 74.683   Median :   23.86   Median : 25.317  
##  Mean   : 66.646   Mean   :  -17.77   Mean   : 33.353  
##  3rd Qu.: 95.672   3rd Qu.:   45.88   3rd Qu.: 62.727  
##  Max.   :124.465   Max.   :  400.90   Max.   : 99.082  
## 
##     APALANCA            MATRIZ           DIMENSION        
##  Min.   :-6905.772   Length:50          Length:50         
##  1st Qu.:    7.586   Class :character   Class :character  
##  Median :  126.208   Mode  :character   Mode  :character  
##  Mean   :  784.430                                        
##  3rd Qu.:  763.952                                        
##  Max.   :12244.351</code></pre>
<p>Antes de proceder al <em>análisis de la varianza</em> propiamente dicho, hemos de preparar nuestros datos mediante la localización de <em>missing values</em> y <em>outliers</em>. Los <em>outliers</em>, en el ANOVA, pueden tener una gran influencia (ya que se trabaja en <em>términos medios</em>) sobre los resultados, por lo que deben ser tratados convenientemente.</p>
<p>Para localizar los casos concretos de <strong><em>missing values</em></strong>, puede recurrirse a utilizar las herramientas de manejo de <em>data frames</em> del paquete <a href="https://dplyr.tidyverse.org">dplyr</a>. Previamente, realizaremos una <strong>copia</strong> del <em>data frame</em> original, “datos”, a la que llamaremos “muestra”, que es con la que trabajaremos (para mantener la integridad del primer <em>data frame</em>). Con la función <code>vismiss()</code> del paquete <a href="https://docs.ropensci.org/visdat/">visdat</a> podemos tener una visión gráfica general de los valores faltantes, en especial en el caso de la variable RENECO y el factor DIMENSION. Si hay casos faltantes en una de estas variables, los identificaremos filtrando el <em>data frame</em> con la función <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> de <a href="https://dplyr.tidyverse.org">dplyr</a>. Ante la existencia de <em>missing values</em>, se puede actuar de varios modos. Por ejemplo, <strong>se puede intentar obtener por otro canal de información el conjunto de valores</strong> de RENECO que no están disponibles, <strong>o recurrir a alguna estimación</strong> para los mismos y asignarlos. En caso de que esto sea difícil, se puede optar, simplemente, por <strong>eliminar</strong> estos casos, en especial cuando representan un porcentaje muy reducido respecto al total de casos. En nuestro ejemplo, vamos a suponer que hemos optado por esta última vía, al no conseguir unos valores más o menos verosímiles de RENECO para las empresas de las que se carece de dato. Así, estos casos, finalmente, será exluidos del análisis, utilizando para ello un nuevo filtro:</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Missing values</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/visdat/">visdat</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/visdat/reference/vis_miss.html">vis_miss</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-254-1.png" width="672"></div>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">RENECO</span>, <span class="va">DIMENSION</span><span class="op">)</span></span></code></pre></div>
<pre><code>##                       RENECO DIMENSION
## Sargon Energias SLU       NA     MEDIA
## Viesgo Renovables SL.     NA     MEDIA</code></pre>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">muestra</span> <span class="op">&lt;-</span> <span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Tras el código anterior, se han eliminado del <em>data frame</em> “muestra” las empresas “Sargon Energías S. L. U.” y “Viesgo Renovables S. L.”, empresas pertenecientes a grupos empresariales de dimensión media (DIMENSION), debido a que carecían de dato de rentabilidad económica (RENECO).</p>
<p>Una vez tratados los casos con valores perdidos o <em>missing values</em>, <strong>es necesario detectar la presencia de <em>outliers</em></strong> o casos atípicos en la muestra, que pudieran desvirtuar los resultados derivados del ANOVA. Para ello, realizaremos un <strong><em>boxplot</em></strong> o gráfico de caja. Aplicaremos, por ejemplo, el código siguiente, que utiliza la gramática del paquete <a href="https://ggplot2.tidyverse.org">ggplot2</a>:</p>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Outliers</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muestra</span>,</span>
<span>         map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-255-1.png" width="672"></div>
<p>En el gráfico de caja se aprecia claramente que existe un <em>outlier</em>. Para identificar tal empresa, calcularemos, respecto a la variable RENECO, el primer y tercer cuartiles, que nos servirán para construir el filtro que capturará el caso atípico. Así, en el código, las dos primeras filas calculan los cuartiles primero (Q1) y tercero (Q3) mediante la función <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>. Luego se filtran, mediante la función <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> de <a href="https://dplyr.tidyverse.org">dplyr</a>, los <em>outliers</em>, calculadoscomo aquellos casos con valores de RENECO mayores que Q3 más 1,5 veces el <em>rango intercuartílico</em> de la variable; o menores que Q1 menos 1,5 veces dicho rango intercuartílico. Para calcular el rango intercuartílico se recurre a la función <code><a href="https://rdrr.io/r/stats/IQR.html">IQR()</a></code>. Finalmente, con <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> se muestran los casos en la consola de RStudio:</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">Q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span> <span class="op">(</span><span class="va">muestra</span><span class="op">$</span><span class="va">RENECO</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Q3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span> <span class="op">(</span><span class="va">muestra</span><span class="op">$</span><span class="va">RENECO</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">muestra</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">RENECO</span> <span class="op">&gt;</span> <span class="va">Q3</span> <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="va">RENECO</span> <span class="op">&lt;</span> <span class="va">Q1</span> <span class="op">-</span> <span class="fl">1.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span></span></code></pre></div>
<pre><code>##                     RENECO
## Molinos Del Ebro SA 35.262</code></pre>
<p>La empresa identificada como outlier es “Molinos del Ebro S. A”. Como ocurría con los <em>missing values</em>, el tratamiento de los <em>outliers</em> depende de la información que se tenga, existiendo varias alternativas (corrección del dato, estimación, etc.) Si no se tiene información fiable, y los <em>outliers</em> no representan una gran proporción respecto al total de casos, puede optarse por su eliminación de la muestra, como haremos en este ejemplo. Podemos hacerlo creando un nuevo <em>data frame</em> a partir de “muestra”; pero sin ese caso. Ese nuevo <em>data frame</em> se llamará, por ejemplo, “<strong>muestra_so</strong>”:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">muestra_so</span> <span class="op">&lt;-</span> <span class="va">muestra</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">RENECO</span> <span class="op">&lt;=</span> <span class="va">Q3</span> <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                                   <span class="va">RENECO</span> <span class="op">&gt;=</span> <span class="va">Q1</span> <span class="op">-</span> <span class="fl">1.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Una vez preparados los datos, vamos a presentar los grupos de empresas eólicas y sus rentabilidades económicas medias. Para ello, diseñaremos una tabla con la función <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code> del paquete <a href="https://yihui.org/knitr/">knitr</a>, y personalizada con algunas funciones incluidas en el paquete <a href="http://haozhu233.github.io/kableExtra/">kableExtra</a>. Para construir la tabla, hemos de crear anteriormente un pequeño <em>data frame</em>, llamado por ejemplo “tablamedias”, en el que cada caso o fila sea uno de los grupos en que queda dividida la muestra a partir de los niveles del factor “DIMENSION”, y que contenga tres variables: la DIMENSION de cada grupo o submuestra, su número de casos contenidos (variable “observaciones”), y las respectivas rentabilidades medias (variable “media”):</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Visualizando número de frecuencias y medias de los grupos con dplyr:</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span>  <span class="va">knitr.table.format</span> <span class="op">=</span> <span class="st">"html"</span> </span>
<span></span>
<span>  <span class="va">tablamedias</span> <span class="op">&lt;-</span>  <span class="va">muestra_so</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">DIMENSION</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span> <span class="op">(</span>observaciones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">DIMENSION</span><span class="op">)</span>,</span>
<span>                               media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">tablamedias</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="va">knitr.table.format</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Rentabilidad Económica. Medias por grupos (tamaño matriz)."</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tamaño"</span>, <span class="st">"Observaciones"</span>, <span class="st">"Rentabilidad Económica"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, <span class="st">"bordered"</span>, <span class="st">"condensed"</span>,</span>
<span>                position <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                font_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">0</span>, bold<span class="op">=</span> <span class="cn">T</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tablamedias</span><span class="op">)</span>, bold<span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-259">Table 8.1: </span><span id="tab:unnamed-chunk-259">Table 8.2: </span>Rentabilidad Económica. Medias por grupos (tamaño matriz).
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;text-align: center;">
Tamaño
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Observaciones
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Rentabilidad Económica
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;text-align: center;">
GRANDE
</td>
<td style="text-align:right;text-align: center;">
24
</td>
<td style="text-align:right;text-align: center;">
2.721167
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
MEDIA
</td>
<td style="text-align:right;text-align: center;">
13
</td>
<td style="text-align:right;text-align: center;">
7.241154
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
PEQUEÑA
</td>
<td style="text-align:right;text-align: center;">
10
</td>
<td style="text-align:right;text-align: center;">
8.167200
</td>
</tr>
</tbody>
</table></div>
<p>Gráficamente, las tres submuestras de empresas pueden caracterizarse, en cuanto a la rentabilidad económica (RENECO), mediante dos tipos de gráficos: gráficos de densidad y gráficos de caja. Los gráficos serán construidos utilizando las facilidades del paquete <a href="https://ggplot2.tidyverse.org">ggplot2</a>. Además, combinaremos los gráficos en una composición utilizando el paquete <a href="https://patchwork.data-imaginist.com">patchwork</a>. El código es el siguiente:</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Graficando casos y medias.</span></span>
<span></span>
<span>  <span class="co"># Crear el gráfico de densidad</span></span>
<span>  <span class="va">gdensidad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">muestra_so</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>, color <span class="op">=</span> <span class="va">DIMENSION</span>, fill <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tablamedias</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">media</span>, color <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Diagramas de Densidad por Grupo con Medias"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Rentabilidad Económica (%)"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Densidad"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Crear box-plot</span></span>
<span>  <span class="va">gbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muestra_so</span>,</span>
<span>         map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">DIMENSION</span>,</span>
<span>                    x <span class="op">=</span> <span class="va">RENECO</span>,</span>
<span>                    color <span class="op">=</span> <span class="va">DIMENSION</span>,</span>
<span>                    fill <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.60</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>tittle <span class="op">=</span><span class="st">"Diagramas de caja por Grupo con Medias"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Rentabilidad Económica (%)"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Submuestras"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Combinar gráficos.</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">gdensidad</span> <span class="op">/</span> <span class="va">gbox</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-260-1.png" width="672"></div>
<p>Cada grupo o submuestra “representa” a una subpoblación, según la dimensión que tenga la matriz empresarial. El ANOVA lo que intenta determinar es si, observadas las diferencias en las medias muestrales de la variable en estudio (aquí, RENECO), esas diferencias pueden considerarse o no estadísticamente significativas a nivel poblacional. En realidad, la hipótesis nula a contrastar es que ninguna de las diferencias entre las medias de la variable de las subpoblacionales es estadísticamente significativa; mientras que la hipótesis alternativa es que existe al menos una diferencia significativa entre las medias de las subpoblaciones. En definitiva, la <strong>hipótesis nula</strong> a contrastar sugiere <strong>que no existen diferencias entre las rentabilidades económicas medias de los grupos</strong> (subpoblaciones) de empresas eólicas (discriminadas por el tamaño del grupo empresarial al que pertenecen). De ser así, el factor DIMENSION no tendría una influencia estadísticamente significativa sobre el valor medio de la variable RENECO.</p>
<p>Las conclusiones a las que lleguemos con el <em>contraste F de ANOVA</em> serán válidas en la medida en que se cumplan las <strong>hipótesis de normalidad y homogeneidad en las varianzas</strong> de la variable dependiente o métrica (RENECO), en los tres grupos o subpoblaciones en que queda dividida la población atendiendo los niveles o categorías del factor (DIMENSION). Hemos de contrastar, pues, ambas hipótesis, a partir de la información de las tres submuestras que tenemos y que representan, respectivamente, a cada una de esas subpoblaciones.</p>
<p>En cuanto a la hipótesis de <strong>normalidad</strong>, se pueden usar dos vías para verificar su cumplimiento: el análisis gráfico y la realización de contrastes estadísticos.</p>
<p>El análisis gráfico puede llevarse a cabo mediante la realización <em>de gráficos QQ</em> de la variable RENECO, a partir de las submuestras o grupos de empresas en que queda fragmentada la muestra a partir de la variable DIMENSION. Estos gráficos pueden generarse con la gramática del paquete <a href="https://ggplot2.tidyverse.org">ggplot2</a>:</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PRERREQUISITOS / HIPÓTESIS ANOVA  </span></span>
<span></span>
<span>    <span class="co"># Normalidad / Gráfico QQ</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muestra_so</span>,</span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dark blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA: QQ-PLOT"</span>,</span>
<span>            subtitle <span class="op">=</span> <span class="st">"Empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">DIMENSION</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-261-1.png" width="672"></div>
<p>Los <em>gráficos QQ</em> parecen inidicar que la variable RENECO tiene un comportamiento distante a la Ley Normal en las submuestras (y, por tanto, en las correspondientes subpoblaciones), al localizarse, algunos de los puntos, relativamente alejados de la diagonal, especialmente en el caso de las empresas pertenecientes a matrices de dimensión “grande”. Para extraer una conclusión de un modo más preciso, vamos a realizar el contraste de normalidad de <em>Shapiro-Wilk</em>:</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># Normalidad: Shapiro-Wilk para cada grupo</span></span>
<span>    <span class="va">normalidad</span> <span class="op">&lt;-</span> <span class="va">muestra_so</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">DIMENSION</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>shapiro_p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">RENECO</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>decide <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">shapiro_p_value</span> <span class="op">&gt;</span> <span class="fl">0.05</span>,</span>
<span>                            <span class="st">"NORMALIDAD"</span>,</span>
<span>                            <span class="st">"NO-NORMALIDAD"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">tablashapiro</span> <span class="op">&lt;-</span> <span class="va">normalidad</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="va">knitr.table.format</span>,</span>
<span>          caption <span class="op">=</span> <span class="st">"Normalidad (Shapiro-Wilks)"</span>,</span>
<span>          col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dimensión"</span>, <span class="st">"p-valor"</span>, <span class="st">"Conclusión"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                  bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, <span class="st">"bordered"</span>, <span class="st">"condensed"</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                  font_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">0</span>, bold<span class="op">=</span> <span class="cn">T</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">normalidad</span><span class="op">)</span>, bold<span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">tablashapiro</span></span></code></pre></div>
<p>En el código anterior, se crea un pequeño <em>data frame</em> denominado “normalidad”, que incluye, para cada submuestra definida por los niveles del factor DIMENSION, la variable “decide” con los <em>p-valores</em> de la prueba de <em>Shapiro-Wilk</em>, y un atributo llamado “decide”, creado mediante la función <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> de <a href="https://dplyr.tidyverse.org">dplyr</a>, que adopta la categoría “NORMALIDAD” o “NO-NORMALIDAD” dependiendo de los p-valores. Posteriormente, el data frame “normalidad” se presenta como una tabla de nombre “tablashapiro”.</p>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-263">Table 8.3: </span><span id="tab:unnamed-chunk-263">Table 8.4: </span>Normalidad (Shapiro-Wilks).
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;text-align: center;">
Dimensión
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
p-valor
</th>
<th style="text-align:left;font-weight: bold;text-align: center;">
Conclusión
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;text-align: center;">
GRANDE
</td>
<td style="text-align:right;text-align: center;">
0.038
</td>
<td style="text-align:left;text-align: center;">
NO-NORMALIDAD
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
MEDIA
</td>
<td style="text-align:right;text-align: center;">
0.698
</td>
<td style="text-align:left;text-align: center;">
NORMALIDAD
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
PEQUEÑA
</td>
<td style="text-align:right;text-align: center;">
0.134
</td>
<td style="text-align:left;text-align: center;">
NORMALIDAD
</td>
</tr>
</tbody>
</table></div>
<p>En esta prueba, la hipótesis nula equivale al supuesto de normalidad. Para un 5% de significación estadística, un <strong>p-valor superior a 0,05 implicará el no-rechazo de la hipótesis nula de normalidad</strong>. En el ejemplo, la submuestra de empresas pertenecientes a matrices de dimensión “grande” llevan a pensar que esta subpoblación no sigue una distribución normal. En los otros dos casos, en cambio, podemos aceptar la existencia de normalidad.</p>
<p>En cuanto a la <strong>homogeneidad de las varianzas</strong>, contrastamos este supuesto mediante la prueba de <em>Bartlett</em>.</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># Homogeneidad en las varianzas</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">muestra_so</span><span class="op">$</span><span class="va">RENECO</span> <span class="op">~</span> <span class="va">muestra_so</span><span class="op">$</span><span class="va">DIMENSION</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  muestra_so$RENECO by muestra_so$DIMENSION
## Bartlett's K-squared = 9.389, df = 2, p-value = 0.009146</code></pre>
<p>El p-valor es menor que 0,05; luego <strong>se rechaza la hipótesis nula de homogeneidad de las varianzas de los grupos (subpoblaciones)</strong>.</p>
<p>Puesto que en uno de los grupos (subpoblaciones) se rechaza la hipótesis de normalidad, y (sobre todo) puesto que no se puede considerar una dispersión similar en las tres subpoblaciones (varianzas homogéneas), los resultados de la prueba <strong><em>F de ANOVA</em></strong> pierden validez, y habría que optar por <strong>una alternativa robusta</strong>. No obstante, <strong>a modo ilustrativo</strong>, seguiremos adelante con la prueba <em>F de ANOVA</em>.</p>
<p>El contraste <em>F de ANOVA</em> de igualdad en las medias de la variable en estudio (rentabilidad económica, RENECO) de las distintas (sub)poblaciones (grupos de empresas según el tamaño del grupo empresarial de pertenencia) se realiza en R mediante la función <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>, que guardaremos, por ejemplo, como el objeto “Datos.aov”, y que se almacenará en forma resumida en la lista “summary_aov”, de un solo elemento. Este elemento, que contiene la solución resumida del contraste ANOVA, se convierte en un <em>data frame</em> (de nombre “aov_table”) con el objetivo de presentarlo como una tabla de <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code>:</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test F de ANOVA</span></span>
<span></span>
<span><span class="va">Datos.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">muestra_so</span><span class="op">$</span><span class="va">RENECO</span> <span class="op">~</span> <span class="va">muestra_so</span><span class="op">$</span><span class="va">DIMENSION</span><span class="op">)</span></span>
<span><span class="va">summary_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Datos.aov</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Extraer los resultados del ANOVA</span></span>
<span>  <span class="va">aov_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">summary_aov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Convertir la tabla en una tabla de kable</span></span>
<span>  <span class="va">aov_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="va">knitr.table.format</span>,</span>
<span>          caption <span class="op">=</span> <span class="st">"Resultados del ANOVA"</span>,</span>
<span>          col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Grados Libertad"</span>,</span>
<span>                        <span class="st">"Suma cuadrados"</span>,</span>
<span>                        <span class="st">"Media suma cuadrados"</span>,</span>
<span>                        <span class="st">"Estadístico F"</span>,</span>
<span>                        <span class="st">"p-valor"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                  bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, <span class="st">"bordered"</span>, <span class="st">"condensed"</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                  font_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">0</span>, bold<span class="op">=</span> <span class="cn">T</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">aov_table</span><span class="op">)</span>, bold<span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-266">Table 8.5: </span><span id="tab:unnamed-chunk-266">Table 8.6: </span>Resultados del ANOVA
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;text-align: center;">
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Grados Libertad
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Suma cuadrados
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Media suma cuadrados
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Estadístico F
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
p-valor
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;text-align: center;">
muestra_so$DIMENSION
</td>
<td style="text-align:right;text-align: center;">
2
</td>
<td style="text-align:right;text-align: center;">
289.4459
</td>
<td style="text-align:right;text-align: center;">
144.72296
</td>
<td style="text-align:right;text-align: center;">
8.720764
</td>
<td style="text-align:right;text-align: center;">
0.0006453
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
Residuals
</td>
<td style="text-align:right;text-align: center;">
44
</td>
<td style="text-align:right;text-align: center;">
730.1895
</td>
<td style="text-align:right;text-align: center;">
16.59522
</td>
<td style="text-align:right;text-align: center;">
NA
</td>
<td style="text-align:right;text-align: center;">
NA
</td>
</tr>
</tbody>
</table></div>
<p>El valor del estadístico F de ANOVA es de 8,721; con un p-valor asociado de 0,0006. Como el p-valor es menor que 0,05, <strong>se rechaza la hipótesis nula de medias iguales</strong>; por lo que podremos afirmar (para una significación del 5%) que <strong>el tamaño o dimensión del grupo empresarial de pertenencia influye, en media, en la rentabilidad económica obtenida</strong>.</p>
</div>
<div id="comparaciones-múltiples." class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Comparaciones múltiples.<a class="anchor" aria-label="anchor" href="#comparaciones-m%C3%BAltiples."><i class="fas fa-link"></i></a>
</h2>
<p>Cuando el resultado del contraste <em>F de ANOVA</em> es de rechazo de la hipótesis nula, se presenta otra cuestión interesante. La hipótesis alternativa dice que existe al menos una diferencia entre las medias de dos grupos que es “importante”. Pero no tienen porque ser todas. Entonces, cabe preguntarse que diferencias concretas entre medias son estadísticamente significativas, y cuáles no. Para dilucidar esta cuestión se han desarrollado diversas pruebas de <strong>comparaciones múltiples</strong>. Una de ellas es la prueba <em>HSD de Tuckey</em>. Un modo de obtener los resultados de esta prueba es ejecutarla a partir de las funciones del paquete <a href="https://rvlenth.github.io/emmeans/">emmeans</a>. En concreto, los resultados de la prueba <em>HSD de</em> <em>Tuckey</em> se obtendrán aplicando la función <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code> a un objeto creado previamente con la función <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans()</a></code>, al que hemos llamado, por ejemplo, “medias”, y que tiene como argumentos el nombre de nuestra solución del contraste ANOVA anterior y, entrecomillado, el nombre de la variable que actúa como factor que divide a la muestra en los tres grupos (submuestras) comparados (DIMENSION). Los resultados se han guardado en el objeto “pares”, que posteriormente se ha transformado en un <em>data frame</em> para poder ser presentado como una tabla de <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code>:</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># COMPARACIONES MÚLTIPLES</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/">emmeans</a></span><span class="op">)</span></span>
<span><span class="va">medias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">Datos.aov</span>, <span class="st">"DIMENSION"</span><span class="op">)</span></span>
<span><span class="va">pares</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">medias</span><span class="op">)</span></span>
<span><span class="va">pares_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pares</span><span class="op">)</span></span>
<span><span class="va">pares_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="va">knitr.table.format</span>,</span>
<span>        caption <span class="op">=</span> <span class="st">"Resultados comparaciones múltiples"</span>,</span>
<span>        col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Grupos"</span>,</span>
<span>                      <span class="st">"Diferencia estimada"</span>,</span>
<span>                      <span class="st">"Desviación Típica"</span>,</span>
<span>                      <span class="st">"Grados de libertad"</span>,</span>
<span>                      <span class="st">"Estadístico t"</span>,</span>
<span>                      <span class="st">"p-valor"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, <span class="st">"bordered"</span>, <span class="st">"condensed"</span>,</span>
<span>                position <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                font_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">0</span>, bold<span class="op">=</span> <span class="cn">T</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pares_df</span><span class="op">)</span>, bold<span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-268">Table 8.7: </span><span id="tab:unnamed-chunk-268">Table 8.8: </span>Resultados comparaciones múltiples
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;text-align: center;">
Grupos
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Diferencia estimada
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Desviación Típica
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Grados de libertad
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Estadístico t
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
p-valor
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;text-align: center;">
GRANDE - MEDIA
</td>
<td style="text-align:right;text-align: center;">
-4.5199872
</td>
<td style="text-align:right;text-align: center;">
1.402862
</td>
<td style="text-align:right;text-align: center;">
44
</td>
<td style="text-align:right;text-align: center;">
-3.2219752
</td>
<td style="text-align:right;text-align: center;">
0.0066466
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
GRANDE - PEQUEÑA
</td>
<td style="text-align:right;text-align: center;">
-5.4460333
</td>
<td style="text-align:right;text-align: center;">
1.533294
</td>
<td style="text-align:right;text-align: center;">
44
</td>
<td style="text-align:right;text-align: center;">
-3.5518532
</td>
<td style="text-align:right;text-align: center;">
0.0026160
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
MEDIA - PEQUEÑA
</td>
<td style="text-align:right;text-align: center;">
-0.9260462
</td>
<td style="text-align:right;text-align: center;">
1.713498
</td>
<td style="text-align:right;text-align: center;">
44
</td>
<td style="text-align:right;text-align: center;">
-0.5404418
</td>
<td style="text-align:right;text-align: center;">
0.8518522
</td>
</tr>
</tbody>
</table></div>
<p>En la tabla generada, cada fila recoge la diferencia entre la rentabilidad media de las empresas incluidas en las submuestras de los distintos niveles de dimensión de los grupos empresariales a los que perteneces dichas empresas. En la última columna, se muestran los <em>p-valores.</em> La hipótesis nula implica que la diferencia entre las rentabilidades medias de los dos grupos implicados son tan pequeñas que pueden considerarse nulas. Por tanto, p-valores muy pequeños (menores que 0,05) implican un rechazo de esta hipótesis, y la admisión de que esas difrencias son significativamente distintas a 0, o sea, “importantes”. Por tanto, en el ejemplo se concluye que las rentabilidad media del grupo de empresas de matrices de dimensión “grande” difiere significativamente con respecto a las rentabilidades medias de los otros dos grupos. En cambio, las rentabilidades medias de los grupos de empresas de matrices de dimensión “media” y “pequeña” no difieren significativamente.</p>
</div>
<div id="y-si-no-se-cumplen-las-condiciones-para-realizar-el-contraste-f-de-anova" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> ¿Y si no se cumplen las condiciones para realizar el contraste F de ANOVA?<a class="anchor" aria-label="anchor" href="#y-si-no-se-cumplen-las-condiciones-para-realizar-el-contraste-f-de-anova"><i class="fas fa-link"></i></a>
</h2>
<p>En el ejemplo anterior hemos visto cómo, aunque hemos seguido el procedimiento de realización del contraste F de ANOVA y la prueba HSD de Tuckey de comparaciones múltiples; no sé cumplían algunos de los requisitos necesarios para confiar en los resultados de estos contrastes: la normalidad de las subpoblaciones (medida a través de las submuestras) y la homogeneidad de las varianzas de estas.</p>
<p>Cuando esto ocurre, es necesario recurrir a técnicas robustas, puesto que el comportamiento de la variable analizada en las subpoblaciones (grupos) no se ajusta al necesario para poder aplicar los contrastes anteriores.</p>
<p>Una prueba robusta que puede suplir al contraste F de ANOVA es la de Kruskal-Wallis. En esta prueba, la hipótesis nula vuelve a ser que no existen diferencias significativas entre las medias de la variable estudiada de las diferentes subpoblaciones (representadas por las correspondientes submuestras), mientras que la hipótesis alternativa apuesta porquela existencia al menos una diferencia significativa. Para aplicar la prueba de Kruskal-Wallis en R, puede recurrirse a la función <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> del paquete <a href="https://github.com/pgiraudoux/pgirmess">pgirmess</a>. Así, en nuestro ejemplo, tenemos:</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Cuando se incumplen las hipotesis de ANOVA (test robusto)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pgiraudoux/pgirmess">pgirmess</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos.K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">muestra_so</span><span class="op">$</span><span class="va">RENECO</span> <span class="op">~</span> <span class="va">muestra_so</span><span class="op">$</span><span class="va">DIMENSION</span><span class="op">)</span></span>
<span><span class="va">Datos.K</span></span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  muestra_so$RENECO by muestra_so$DIMENSION
## Kruskal-Wallis chi-squared = 14.718, df = 2, p-value = 0.0006368</code></pre>
<p>Puede comprobarse cómo el <em>p-valor</em> es muy pequeño (menor a 0,05), por lo que hemos de rechazar la hipótesis nula de medias iguales y admitir que <strong>existe al menos dos grupos (subpoblaciones) en los que la diferencia entre la rentabilidad económica media es significativa</strong>.</p>
<p>De nuevo, si se rechaza la hipótesis nula, cabe preguntarse cuáles son los grupos o subpoblaciones concretas cuyas medias de rentabilidad económica son significativamente diferentes. Kruskal-Wallis desarrollaron también la versión robusta de la prueba <em>HSD de Tuckey</em>, que se incluye en <a href="https://github.com/pgiraudoux/pgirmess">pgirmess</a>, con la función <code><a href="https://rdrr.io/pkg/pgirmess/man/kruskalmc.html">kruskalmc()</a></code>. En el siguiente código se aplica la función, cuya solución se guarda en el objeto “Datos.kmc”. El elemento de la solución “dif.com”, que contiene las comparaciones entre las medias, se pasa a un <em>data frame</em> para poder ser mostrado como una tabla de <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code>:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Comparaciones múltiples</span></span>
<span></span>
<span>  <span class="va">Datos.kmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pgirmess/man/kruskalmc.html">kruskalmc</a></span><span class="op">(</span><span class="va">muestra_so</span><span class="op">$</span><span class="va">RENECO</span> <span class="op">~</span> <span class="va">muestra_so</span><span class="op">$</span><span class="va">DIMENSION</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Convertir los resultados a un data frame</span></span>
<span></span>
<span>  <span class="va">Datos.kmc.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">Datos.kmc</span><span class="op">$</span><span class="va">dif.com</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Datos.kmc.df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="va">knitr.table.format</span>,</span>
<span>          caption <span class="op">=</span> <span class="st">"Kruskal-Wallis. Múltiples diferencias"</span>,</span>
<span>          col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Diferencias medias"</span>,</span>
<span>                        <span class="st">"Diferencias críticas"</span>,</span>
<span>                        <span class="st">"Significación"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                  bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,</span>
<span>                                        <span class="st">"bordered"</span>,</span>
<span>                                        <span class="st">"condensed"</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                  font_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">T</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Datos.kmc.df</span><span class="op">)</span>, bold <span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-striped table-bordered table-condensed" style="font-size: 11px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-271">Table 8.9: </span><span id="tab:unnamed-chunk-271">Table 8.10: </span>Kruskal-Wallis. Múltiples diferencias
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;text-align: center;">
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Diferencias medias
</th>
<th style="text-align:right;font-weight: bold;text-align: center;">
Diferencias críticas
</th>
<th style="text-align:left;font-weight: bold;text-align: center;">
Significación
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;text-align: center;">
GRANDE-MEDIA
</td>
<td style="text-align:right;text-align: center;">
16.381410
</td>
<td style="text-align:right;text-align: center;">
11.30376
</td>
<td style="text-align:left;text-align: center;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
GRANDE-PEQUEÑA
</td>
<td style="text-align:right;text-align: center;">
13.758333
</td>
<td style="text-align:right;text-align: center;">
12.35473
</td>
<td style="text-align:left;text-align: center;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;text-align: center;">
MEDIA-PEQUEÑA
</td>
<td style="text-align:right;text-align: center;">
2.623077
</td>
<td style="text-align:right;text-align: center;">
13.80676
</td>
<td style="text-align:left;text-align: center;">
FALSE
</td>
</tr>
</tbody>
</table></div>
<p>En la tabla generada se comprueba cómo las diferencias que la media de la rentabilidad económica de la subpoblación de empresas pertenecientes a matrices de dimensión “grande” son significativas (para un 0,05 de significación). En cambio, las rentabilidades económicas medias de las empresas pertenecientes a matrices de dimensiones “media” y “pequeña” no difieren entre sí de modo significativo.</p>
</div>
<div id="materiales-para-realizar-las-prácticas-del-capítulo.-6" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Materiales para realizar las prácticas del capítulo.<a class="anchor" aria-label="anchor" href="#materiales-para-realizar-las-pr%C3%A1cticas-del-cap%C3%ADtulo.-6"><i class="fas fa-link"></i></a>
</h2>
<p>En esta sección se muestran los links de acceso a los diferentes materiales (<em>scripts</em>, datos…) necesarios para llevar a cabo los contenidos prácticos del capítulo.</p>
<p><strong>Datos (en formato Microsoft (R) Excel (R)):</strong></p>
<ul>
<li>eolica_50.xlsx (<a href="https://docs.google.com/spreadsheets/d/1PVRwLo1eAbFLOgSscLZw0bD9rgMk2X-w/edit?usp=sharing&amp;ouid=115375878280465826079&amp;rtpof=true&amp;sd=true">obtener aquí</a>)</li>
</ul>
<p><strong>Scripts:</strong></p>
<ul>
<li>anova_eolica.R <a href="https://drive.google.com/file/d/1p4p17OudRprwkpF7wvvF1gwHZG82uv89/view?usp=sharing">(obtener aquí</a>)</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="an%C3%A1lisis-cl%C3%BAster..html"><span class="header-section-number">7</span> Análisis Clúster.</a></div>
<div class="next"><a href="an%C3%A1lisis-de-regresi%C3%B3n-lineal-m%C3%BAltiple..html"><span class="header-section-number">9</span> Análisis de Regresión Lineal Múltiple.</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#an%C3%A1lisis-de-la-varianza."><span class="header-section-number">8</span> Análisis de la varianza.</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n.-4"><span class="header-section-number">8.1</span> Introducción.</a></li>
<li><a class="nav-link" href="#anova-de-un-solo-factor."><span class="header-section-number">8.2</span> ANOVA de un solo factor.</a></li>
<li><a class="nav-link" href="#comparaciones-m%C3%BAltiples."><span class="header-section-number">8.3</span> Comparaciones múltiples.</a></li>
<li><a class="nav-link" href="#y-si-no-se-cumplen-las-condiciones-para-realizar-el-contraste-f-de-anova"><span class="header-section-number">8.4</span> ¿Y si no se cumplen las condiciones para realizar el contraste F de ANOVA?</a></li>
<li><a class="nav-link" href="#materiales-para-realizar-las-pr%C3%A1cticas-del-cap%C3%ADtulo.-6"><span class="header-section-number">8.5</span> Materiales para realizar las prácticas del capítulo.</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R-Stars: La Guía</strong>" was written by Miguel-Ángel Tarancón. It was last built on 2025-09-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
