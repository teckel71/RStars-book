<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Gráficos. | R-Stars: La Guía</title>
<meta name="author" content="Miguel-Ángel Tarancón">
<meta name="description" content="3.1 Tidyverse para gráficos: ggplot2. R, en su instalación básica, cuenta con funciones destinadas a crear gráficos y, de este modo, visualizar nuestros datos a fin de generar información y...">
<meta name="generator" content="bookdown 0.44 with bs4_book()">
<meta property="og:title" content="3 Gráficos. | R-Stars: La Guía">
<meta property="og:type" content="book">
<meta property="og:url" content="https://teckel71.github.io/RStars-book/gráficos..html">
<meta property="og:image" content="https://teckel71.github.io/RStars-book/figuras/Portada_v3-2.jpg">
<meta property="og:description" content="3.1 Tidyverse para gráficos: ggplot2. R, en su instalación básica, cuenta con funciones destinadas a crear gráficos y, de este modo, visualizar nuestros datos a fin de generar información y...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Gráficos. | R-Stars: La Guía">
<meta name="twitter:description" content="3.1 Tidyverse para gráficos: ggplot2. R, en su instalación básica, cuenta con funciones destinadas a crear gráficos y, de este modo, visualizar nuestros datos a fin de generar información y...">
<meta name="twitter:image" content="https://teckel71.github.io/RStars-book/figuras/Portada_v3-2.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Inter-0.4.10/font.css" rel="stylesheet">
<link href="libs/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="libs/Inter_Tight-0.4.10/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="assets/styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R-Stars: La Guía</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li><a class="" href="prefacio.html">Prefacio</a></li>
<li><a class="" href="introducci%C3%B3n..html"><span class="header-section-number">1</span> Introducción.</a></li>
<li><a class="" href="almacenando-y-manipulando-datos..html"><span class="header-section-number">2</span> Almacenando y manipulando datos.</a></li>
<li><a class="active" href="gr%C3%A1ficos..html"><span class="header-section-number">3</span> Gráficos.</a></li>
<li><a class="" href="estad%C3%ADstica-descriptiva..html"><span class="header-section-number">4</span> Estadística descriptiva.</a></li>
<li><a class="" href="an%C3%A1lisis-previo-de-datos..html"><span class="header-section-number">5</span> Análisis previo de datos.</a></li>
<li><a class="" href="componentes-principales..html"><span class="header-section-number">6</span> Componentes principales.</a></li>
<li><a class="" href="an%C3%A1lisis-cl%C3%BAster..html"><span class="header-section-number">7</span> Análisis Clúster.</a></li>
<li><a class="" href="an%C3%A1lisis-de-la-varianza..html"><span class="header-section-number">8</span> Análisis de la varianza.</a></li>
<li><a class="" href="an%C3%A1lisis-de-regresi%C3%B3n-lineal-m%C3%BAltiple..html"><span class="header-section-number">9</span> Análisis de Regresión Lineal Múltiple.</a></li>
<li><a class="" href="an%C3%A1lisis-de-datos-cualitativos..html"><span class="header-section-number">10</span> Análisis de Datos Cualitativos.</a></li>
<li><a class="" href="bibliograf%C3%ADa.html">Bibliografía</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="gráficos." class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Gráficos.<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos."><i class="fas fa-link"></i></a>
</h1>
<div id="tidyverse-para-gráficos-ggplot2." class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Tidyverse para gráficos: ggplot2.<a class="anchor" aria-label="anchor" href="#tidyverse-para-gr%C3%A1ficos-ggplot2."><i class="fas fa-link"></i></a>
</h2>
<p>R, en su instalación básica, cuenta con funciones destinadas a crear gráficos y, de este modo, visualizar nuestros datos a fin de generar información y extraer conclusiones de un modo sencillo. No obstante, estas funciones, a veces, se quedan “cortas”, o requieren de un complejo y/o extenso código. Esta es la razón por la que en el <em>Tidyverse</em> se incluyó un paquete específico destinado a la construcción de gráficos de un modo flexible y amigable. Recordemos que el <em>Tidyverse</em> es un conjunto de paquetes con una filosofía común, como es el uso de ciertas estructuras gramaticales, que facilitan muchas de las tareas y análisis que podrían hacerse con el lenguaje R estándar.</p>
<p>Este paquete destinado a la producción de gráficos es <a href="https://ggplot2.tidyverse.org">ggplot2</a>, que proporciona unas herramientas muy flexibles para visualizar conjuntos de datos. A continuación, se expondrán los fundamentos de la sintaxis de <a href="https://ggplot2.tidyverse.org">ggplot2</a> y se indicará cómo construir algunos de los gráficos más habituales.</p>
<p>Para ilustrar la creación de gráficos, vamos a suponer que trabajamos dentro de un proyecto que hemos creado previamente, de nombre “explora”. Dentro de la carpeta del proyecto guardaremos el <em>script</em> llamado “<a href="https://drive.google.com/file/d/1R0qYnrjcel4SOH9lVI1_qkccKYXBLLDC/view?usp=sharing">explora_ggplot2.R</a>” y el archivo de <em>Microsoft® Excel®</em> llamado “<a href="https://docs.google.com/spreadsheets/d/1Up5ZWR57rgIkmYJcr2Pek6kUdG_yd4vu/edit?usp=drive_link&amp;ouid=115375878280465826079&amp;rtpof=true&amp;sd=true">eolica_100.xlsx</a>”.</p>
<p>Si abrimos este último archivo, comprobaremos que se compone de tres hojas. La primera muestra un aviso sobre el uso de los datos; la segunda recoge la descripción de las variables consideradas; y la tercera (hoja “Datos”) guarda los datos que debemos importar desde R-Studio. Estos datos se corresponden con diferentes variables económico-financieras de las 100 empresas productoras de electricidad mediante generación eólica con mayor volumen de activo total.</p>
<p>Tras abrir el <em>script</em> “explora_ggplot2.R” e el editor de R-Studio, observaremos que la primera línea / instrucción es:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>La instrucción tiene como objeto limpiar el <em>Environment</em> (memoria) de objetos de anteriores sesiones de trabajo.</p>
<p>Para importar los datos que hay en la hoja “Datos” del archivo de Microsoft® Excel® llamado “eolica_100.xlsx”, ejecutaremos el código:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">eolica_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"eolica_100.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span> <span class="op">(</span><span class="va">eolica_100</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     NOMBRE               RES               ACTIVO             FPIOS        
##  Length:100         Min.   : -5661.5   Min.   :   24944   Min.   : -77533  
##  Class :character   1st Qu.:   670.2   1st Qu.:   34437   1st Qu.:   2305  
##  Mode  :character   Median :  2114.7   Median :   46896   Median :  11936  
##                     Mean   : 11477.3   Mean   :  274756   Mean   : 123743  
##                     3rd Qu.:  3951.2   3rd Qu.:   85543   3rd Qu.:  28292  
##                     Max.   :727548.0   Max.   :13492812   Max.   :6904824  
## 
##      RENECO           RENFIN            LIQUIDEZ            MARGEN         
##  Min.   :-3.446   Min.   :-359.773   Min.   :  0.0140   Min.   :-2248.157  
##  1st Qu.: 1.421   1st Qu.:   2.556   1st Qu.:  0.6567   1st Qu.:   12.126  
##  Median : 4.144   Median :  15.326   Median :  1.0650   Median :   26.618  
##  Mean   : 5.294   Mean   :  17.243   Mean   :  2.7214   Mean   :    3.583  
##  3rd Qu.: 7.904   3rd Qu.:  31.307   3rd Qu.:  1.6078   3rd Qu.:   39.580  
##  Max.   :35.262   Max.   : 588.190   Max.   :128.4330   Max.   :  400.899  
## 
##    SOLVENCIA         APALANCA           MATRIZ           DIMENSION        
##  Min.   :-40.74   Min.   :-8254.11   Length:100         Length:100        
##  1st Qu.:  4.71   1st Qu.:   16.13   Class :character   Class :character  
##  Median : 16.65   Median :  161.97   Mode  :character   Mode  :character  
##  Mean   : 27.57   Mean   :  345.03                                        
##  3rd Qu.: 45.59   3rd Qu.:  623.13                                        
##  Max.   : 99.08   Max.   :12244.35</code></pre>
<p>Podemos observar cómo, en el <em>Environment,</em> ya aparece un <em>data frame</em> que se llama “eolica_100”, y contiene 12 columnas. R ha considerado la primera columna como una variable de tipo cualitativo o atributo. En realidad, esa columna no es una variable, sino que está formada por los nombres de los diferentes casos u observaciones (filas). Para evitar que R tome la columna de los nombres de los casos como una variable más, podemos redefinir nuestro <em>data frame</em> diciéndole que considere esa primera columna como el conjunto de los <em>nombres de los individuos o casos</em>:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eolica_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">eolica_100</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>En la línea anterior, hemos asignado al <em>data frame</em> “eolica_100” los propios datos de “eolica_100”; pero indicando que la primera columna no es una variable; sino que contiene el nombre de los casos. Si hacemos ahora un <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span> <span class="op">(</span><span class="va">eolica_100</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       RES               ACTIVO             FPIOS             RENECO      
##  Min.   : -5661.5   Min.   :   24944   Min.   : -77533   Min.   :-3.446  
##  1st Qu.:   670.2   1st Qu.:   34437   1st Qu.:   2305   1st Qu.: 1.421  
##  Median :  2114.7   Median :   46896   Median :  11936   Median : 4.144  
##  Mean   : 11477.3   Mean   :  274756   Mean   : 123743   Mean   : 5.294  
##  3rd Qu.:  3951.2   3rd Qu.:   85543   3rd Qu.:  28292   3rd Qu.: 7.904  
##  Max.   :727548.0   Max.   :13492812   Max.   :6904824   Max.   :35.262  
## 
##      RENFIN            LIQUIDEZ            MARGEN            SOLVENCIA     
##  Min.   :-359.773   Min.   :  0.0140   Min.   :-2248.157   Min.   :-40.74  
##  1st Qu.:   2.556   1st Qu.:  0.6567   1st Qu.:   12.126   1st Qu.:  4.71  
##  Median :  15.326   Median :  1.0650   Median :   26.618   Median : 16.65  
##  Mean   :  17.243   Mean   :  2.7214   Mean   :    3.583   Mean   : 27.57  
##  3rd Qu.:  31.307   3rd Qu.:  1.6078   3rd Qu.:   39.580   3rd Qu.: 45.59  
##  Max.   : 588.190   Max.   :128.4330   Max.   :  400.899   Max.   : 99.08  
## 
##     APALANCA           MATRIZ           DIMENSION        
##  Min.   :-8254.11   Length:100         Length:100        
##  1st Qu.:   16.13   Class :character   Class :character  
##  Median :  161.97   Mode  :character   Mode  :character  
##  Mean   :  345.03                                        
##  3rd Qu.:  623.13                                        
##  Max.   :12244.35</code></pre>
<p>Comprobamos que ya no aparece NOMBRE como variable y que, en el <em>Environment</em>, se recoge el <em>data frame</em> “eolica_100” con 100 casos y con 11 variables.</p>
</div>
<div id="gráficos-de-una-variable-histogramas-gráficos-de-densidad-gráficos-de-caja-o-boxplots." class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Gráficos de una variable: histogramas, gráficos de densidad, gráficos de caja o <em>boxplots</em>.<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-una-variable-histogramas-gr%C3%A1ficos-de-densidad-gr%C3%A1ficos-de-caja-o-boxplots."><i class="fas fa-link"></i></a>
</h2>
<p>A continuación, cargaremos el paquete <a href="https://ggplot2.tidyverse.org">ggplot2</a>. Si nunca antes se ha utilizado, cuando lo intentemos activar con la función <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> nos dará un error, advirtiendo que previamente hay que instalarlo. En ese caso, iremos a la ventana inferior-derecha de R-Studio y pulsaremos en la pestaña <code>Packages</code>, luego en <code>Install</code>, y emergerá una ventana donde dejaremos el “repositorio” que viene por defecto y, en el campo <code>Packages</code>, escribiremos el nombre del “paquete” (en nuestro caso <em>ggplot2</em>). Una vez descargado el “paquete”, podremos ejecutar el código sin problemas:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cargando ggplot2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>La primera instrucción para crear un gráfico con el paquete <a href="https://ggplot2.tidyverse.org">ggplot2</a> es <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. A continuación, entre paréntesis, se deberán aportar una serie de argumentos o informaciones. Estas informaciones irán definiendo el gráfico en mayor o menor detalle.</p>
<p>En realidad, lo que se hace es definir el conjunto de datos a representar (que suelen estar contenidos en un <em>data frame</em>, o en varios), y a partir de ellos se van añadiendo capas gráficas o “<em><strong>geoms</strong>”,</em> que son caracterizadas con ciertos atributos estéticos <em>(”</em>aesthetics”<em>, o</em> “aes”).</p>
<div id="histograma." class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Histograma.<a class="anchor" aria-label="anchor" href="#histograma."><i class="fas fa-link"></i></a>
</h3>
<p>Uno de los gráficos indispensables para tener una idea de la distribución de frecuencias que siguen los casos (en nuestro ejemplo, las empresas eólicas) con relación a una variable métrica es el <strong>histograma</strong>. Vamos a construir un histograma para la variable de rentabilidad económica, RENECO. El código será:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histograma</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Como acabamos de decir, en primer lugar viene el comando <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, seguido de unos paréntesis que recogen ciertas informaciones:</p>
<ul>
<li><p><strong>“data =”</strong>, seguido de la fuente que almacena los datos a graficar (en nuestro caso, el <em>data frame</em> “eolica_100”).</p></li>
<li><p><strong>“map =”</strong>, o “mapeo”, que define los aspectos del gráfico que dependen del valor de alguna o algunas variables. Siempre que alguna característica del gráfico no sea “fija”, sino que dependa de los valores que toma una variable, tal variable deberá ir indicada dentro de un <em>elemento estético</em> (<em>aes</em>). En el código de ejemplo, el elemento <em>aes</em> sirve para indicar que las coordenadas del eje x que toman los casos a representar, dependen de los valores de la variable RENECO.</p></li>
</ul>
<p>Para indicar que las siguientes líneas continúan con el código del gráfico, se añade al final de esta línea el símbolo “<strong>+</strong>”.</p>
<p>En la segunda línea, se establece el tipo de gráfico que se va a realizar, mediante la inclusión de un elemento <strong><em>geom</em></strong>. Para decir que lo que queremos construir es un histograma, el elemento <em>geom</em> será <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>.</p>
<p>El resultado del código anterior es el siguiente gráfico:</p>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-123-1.png" width="672"></div>
<p>Por supuesto, <a href="https://ggplot2.tidyverse.org">ggplot2</a> permite personalizar y refinar la apariencia del gráfico. Uno de los aspectos que nos puede interesar modificar es el número de intervalos en los que queda dividido el rango de valores que puede tomar la variable (“grosor” de las barras), o <em>bins</em>. Por defecto, el número es 30. Para incrementar este número de barras a 40, por ejemplo, añadiremos en la línea del <em>geom</em> el argumento <strong>“bins =”</strong>:</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-124-1.png" width="672"></div>
<p>A continuación, vamos a modificar el color de las barras. Para el borde de estas, se utiliza el argumento <strong>“colour =”</strong>; y, para el relleno, <strong>“fill =”</strong>. Además, vamos a mejorar la presentación del gráfico añadiéndole un título y un subtítulo, y unas etiquetas en los ejes. Hay que prestar atención a los signos <strong>“+”</strong> incluidos para que R entienda que el código de la siguiente línea pertenece al mismo gráfico que estamos diseñando:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">40</span>, colour <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frecuencias"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-125-1.png" width="672"></div>
<p>Puede ser que nos interese diferenciar los casos según grupos preestablecidos. Por ejemplo, entre las variables de nuestro <em>data frame</em> “eolica_100”, existe una variable categórica, atributo o factor, denominada DIMENSION, que clasifica a las 100 empresas en “GRANDE”, “MEDIO” o “PEQUEÑO” atendiendo al tamaño del grupo empresarial al que pertenecen (medido en número de empresas). Lo que vamos a hacer es crear, en el mismo gráfico, un histograma de la rentabilidad económica, pero para cada categoría de DIMENSION. Para ello, habrá que incluir esta variable categórica en el “mapeo”, en concreto mediante el argumento “fill =”. <strong>Es</strong> <strong>necesario hacerlo dentro del elemento <em>aes</em></strong>, ya que el resultado (color de grupo de empresas) depende del valor que toma la variable DIMENSION para cada caso o empresa:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>, fill <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">60</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frecuencias"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-126-1.png" width="672"></div>
<p>Como puede comprobarse, se superponen los tres histogramas, con tres colores diferentes, dependiendo de la dimensión considerada. Además, aparece, al lado derecho del gráfico, una leyenda que detalla qué color se asocia a cada uno de los grupos de empresas. La función <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer()</a></code> nos permite personalizar la paleta de colores a utilizar (para ver las paletas disponibles, podemos consultar <a href="https://ggplot2-book.org/scales-colour">esta sección</a> de <span class="citation">(<a href="bibliograf%C3%ADa.html#ref-ggplot22021">Wickham 2021</a>)</span>.</p>
</div>
<div id="gráfico-de-densidad." class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Gráfico de densidad.<a class="anchor" aria-label="anchor" href="#gr%C3%A1fico-de-densidad."><i class="fas fa-link"></i></a>
</h3>
<p>Un gráfico parecido al histograma es el de <strong>densidad</strong>. Un gráfico de densidad estima la función de densidad de probabilidad empírica de la variable representada. En realidad, podemos considerarlo como un histograma “suavizado”. Probemos a ejecutar este código:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Densidad"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-127-1.png" width="672"></div>
<p>En el código se observa la utilización del tipo de gráfico <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code>. Además, desaparece el número de intervalos o <em>bins</em>, y se puede dotar a la función de densidad estimada de un color en su borde (<code>colour=</code>), y de un color de relleno (<code>fill=</code>).</p>
<p>Como en casos anteriores, se puede crear una función de densidad estimada para cada grupo de empresas, eliminando las características, <code>colour=</code> y <code>fill=</code> del bloque del <em>geom</em>, y añadiéndolas en el “mapeo”, dentro del <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>, fill <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">0.70</span>, <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Densidad"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-128-1.png" width="672"></div>
<p>En efecto, el argumento <code>fill=</code> ha pasado a integrarse, en el “mapeo”, dentro de un elemento <code>aes</code>, ya que el color de relleno va a variar dependiendo del grupo de pertenencia de la empresa (variable DIMENSION). Por otro lado, en el <code>geom</code> se ha añadido el argumento <code>alpha=</code>. Esta información consiste en un número de 0 a 1 que gradúa el grado de transparencia / opacidad de los rellenos de las figuras (en este caso las funciones de densidad estimadas) incluidas en los gráficos.</p>
</div>
<div id="gráfico-de-caja-o-box-plot." class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Gráfico de caja o <em>Box-Plot</em>.<a class="anchor" aria-label="anchor" href="#gr%C3%A1fico-de-caja-o-box-plot."><i class="fas fa-link"></i></a>
</h3>
<p>Un tipo muy interesante de gráfico es el de “caja” (<strong><em>box-plot</em></strong>), que informa de la dispersión de una variable. Fijémonos en el siguiente código:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span></span></code></pre></div>
<p>Puede observarse cómo en el “mapeo” se fija la variable que va a determinar las coordenadas del eje “y”. Como es una variable, hay que incluirla en el “mapeo” mediante una característica <code>aes</code>. El <code>geom</code> o tipo de gráfico es <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>, y en este caso no le hemos añadido ninguna característica específica. Las últimas líneas configuran los títulos del gráfico y del eje “y”. El resultado de ejecutar el código es el siguiente gráfico:</p>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-130-1.png" width="672"></div>
<p>El gráfico se caracteriza por una “caja” (rectángulo) central. Esta caja está limitada por el primer y tercer cuartil, luego recoge el 50% de los casos con una rentabilidad económica superior al 25% de los casos con menor rentabilidad, y por debajo del 25% de los casos con la rentabilidad más alta. Así, la altura de la caja es la diferencia entre los cuartiles tercero y primero, que es lo que se denomina “rango intercuartílico” (<em>IQR</em> por las siglas en inglés). La caja, a su vez, está dividida en dos zonas por una línea horizontal, que es la mediana de la distribución: la rentabilidad económica que divide a los casos en dos grupos con el mismo número de casos, uno con los casos de mayor rentabilidad, y otro con los casos de menor rentabilidad.</p>
<p>Por encima y por debajo de la caja se disponen dos segmentos (llamados “bigotes”). Estos “bigotes” recogen los casos con valores en la variable inferiores al primer cuartil (comenzando por la base de la caja, hacia abajo), o superiores al tercer cuartil (comenzando por el techo de la caja, hacia arriba); y que están a menos de <strong>1.5 veces</strong> la altura de la caja. Los casos con valores de rentabilidad inferiores al primer cuartil (por abajo) y superiores al tercero (por arriba), que están alejados de la caja en más de 1.5 veces la altura de esta, se indican con puntos, y se corresponden con los casos conocidos como <strong>casos atípicos</strong> o <strong><em>outliers</em></strong>. La identificación de los <em>outliers</em> es una fase muy importante a la hora de aplicar algunas técnicas estadísticas.</p>
<p>En esta práctica, comprobamos cómo, en el caso de la rentabilidad económica (RENECO), existen dos <em>outliers</em>, es decir, dos casos que presentan sendas rentabilidades anormalmente elevadas (más de un 20%).</p>
<p><a href="https://ggplot2.tidyverse.org">ggplot2</a> permite <strong>integrar en el gráfico medidas estadísticas</strong> y otros cálculos. Por ejemplo, en el box-plot se representa el valor de la mediana; pero no el de la media. Si queremos incluir el valor de la media (u otro estadístico), podemos calcularlo e integrarlo con la función <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>, algo parecido al <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> de <a href="https://dplyr.tidyverse.org">dplyr</a>. El argumento <code>fun = "mean"</code> indica que la medida a calcular y representar es la media aritmética, el argumento <code>geom = "point"</code> el tipo de gráfico para representar esa medida (un punto). También hay otros argumentos opcionales. Para que funcione correctamente el código del gráfico, en el “mapeo” de la función <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> hay que añadir, dentro del <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, x = “” (si no se hace, la ejecución dará un error en el que advierte de que falta el “<em>aesthetics: x</em>”):</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">RENECO</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-131-1.png" width="672"></div>
<p>Se aprecia cómo el valor de la <em>rentabilidad económica media</em> se ha insertado como un punto azul oscuro grueso dentro del gráfico de caja (tiene un valor algo superior a la <em>mediana</em>).</p>
<p>Vamos a refinar el <em>box-plot</em> anterior. Por ejemplo, quizá nos pueda interesar crear un <em>box-plot</em> para cada grupo de empresas, según el tamaño del grupo empresarial de pertenencia (atributo DIMENSION). Esto lo conseguiremos con el código:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DIMENSION</span>, y <span class="op">=</span> <span class="va">RENECO</span>, fill <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>               map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-132-1.png" width="672"></div>
<p>Para construir una caja por categoría de la variable cualitativa o atributo DIMENSION, se ha incluido, en el “mapeo” de la primera línea, el eje x con la variable tal variable DIMENSION. Como, además, queremos que cada caja sea de un color diferente, hemos hecho que los colores de estas dependan de la variable DIMENSION; añadiendo en el <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> del “mapeo” la característica <code>fill=</code> (que se refiere al color de relleno de las cajas). También se ha incluido una línea con el <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer()</a></code> para que los colores de las cajas consistan en diferentes tonalidades de naranjas.</p>
<p>En el ejemplo, el primer bloque de <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> consigue puntear, para cada grupo de empresas, la media de RENECO en dicho grupo, en color azul oscuro. Para comparar mejor estas medias, se ha procedido a unir los puntos con unos segmentos o líneas de color azul oscuro, lo que se consigue con el segundo bloque de <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>. La última línea de ese bloque, <code>map = (aes(group = TRUE)))</code>, obliga a que las líneas vayan de una media a otra de los grupos (de punto azul oscuro a punto azul oscuro).</p>
<p>Como última extensión, se ha considerado que, a veces, es conveniente tener en cuenta la posición de cada caso individual dentro del gráfico. Una opción es utilizar una capa o bloque <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code>. Con este <code>geom</code> se dispondrán, para cada grupo, los valores individuales de la variable RENECO; y para que estos, en su caso, no se solapen, se situarán un poco más a la izquierda o a la derecha, de modo aleatorio. Como los <em>outliers</em> son ya casos individuales, para que no se dupliquen con los provenientes del “jitter”, se indicará en el <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> que, en ese bloque gráfico, no se señalen los <em>outliers</em>. Esto se conseguirá con el argumento <code>outlier.shape = NA</code>. El código, en definitiva, será:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DIMENSION</span>, y <span class="op">=</span> <span class="va">RENECO</span>, fill <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>               map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-133-1.png" width="672"></div>
<p>Como puede observarse, el <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> proporciona, en cada caja, la nube de casos (empresas) individuales, en cuanto a la rentabilidad económica (incluidos los <em>outliers</em>). Las características de estos puntos (amplitud del desplazamiento lateral “aleatorio”, tamaño, color, opacidad) se controlan con diversos argumentos (<code>width=</code>, <code>size=</code>, <code>col=</code>, <code>alpha=</code>).</p>
</div>
</div>
<div id="gráficos-de-dos-variables." class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Gráficos de dos variables.<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-dos-variables."><i class="fas fa-link"></i></a>
</h2>
<div id="gráfico-de-dispersión-o-scatterplot." class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Gráfico de dispersión o <em>scatterplot</em>.<a class="anchor" aria-label="anchor" href="#gr%C3%A1fico-de-dispersi%C3%B3n-o-scatterplot."><i class="fas fa-link"></i></a>
</h3>
<p>Pasamos ahora a comentar un tipo de gráfico muy común cuando trabajamos con dos variables métricas: los <strong>gráficos de dispersión</strong> (o <strong><em>scatterplots</em></strong>). En este tipo de gráficos, cada variable ocupa un eje (x o y), y los puntos internos al gráfico representan los diversos casos u observaciones.</p>
<p>Como ejemplo, vamos a crear un gráfico de dispersión que represente las empresas eólicas en función de su rentabilidad económica (RENECO) y de su rentabilidad financiera (RENFIN). El código es el siguiente:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>, y <span class="op">=</span> <span class="va">RENFIN</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA vs RENTABILIDAD FINANCIERA"</span>, subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Financiera (%)"</span><span class="op">)</span></span></code></pre></div>
<p>El resultado es el siguiente gráfico:</p>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-135-1.png" width="672"></div>
<p>Vamos a refinar el gráfico algo más. En primer lugar, puede ser interesante <strong>distinguir entre los tipos de empresas</strong>, según el tamaño del grupo empresarial al que pertenecen ( variable DIMENSION). Para ello, podemos poner el color de los puntos en el “mapeo”, en función de la variable DIMENSION:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>,</span>
<span>                                     y <span class="op">=</span> <span class="va">RENFIN</span>,</span>
<span>                                     col <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA vs FINANCIERA"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Financiera (%)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-136-1.png" width="672"></div>
<p>En los dos gráficos anteriores pueden observarse puntos (casos) candidatos a ser <em>outliers</em> para cada una de las dos variables analizadas. En el caso de RENECO, ya se pudo advertir esta circunstancia al construir los <em>boxplots</em>.</p>
<p>Por otro lado, podría ser interesante complementar el gráfico con información sobre las dos variables por separado, es decir, con <strong>información sobre las distribuciones marginales</strong>. Existe un paquete complementario a <a href="https://ggplot2.tidyverse.org">ggplot2</a>, llamado <a href="https://github.com/daattali/ggExtra">ggExtra</a>, que puede ayudar fácilmente a este cometido. Para ello, hemos de activar dicho paquete con <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> (si no ha sido previamente instalado, habrá que hacerlo con anterioridad). El segundo paso consistirá en <strong>asignar</strong> nuestro <em>scatterplot</em>, diseñado con la función <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, a un objeto con el nombre que queramos, por ejemplo, “scatter_plus”. Luego, ese objeto, que contiene nuestro gráfico, entrará como argumento en la función de <a href="https://github.com/daattali/ggExtra">ggExtra</a> llamada <code><a href="https://rdrr.io/pkg/ggExtra/man/ggMarginal.html">ggMarginal()</a></code>, como se muestra en el siguiente código:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="st"><a href="https://github.com/daattali/ggExtra">"ggExtra"</a></span><span class="op">)</span></span>
<span><span class="va">scatter_plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>,</span>
<span>                                                     y <span class="op">=</span> <span class="va">RENFIN</span>,</span>
<span>                                                     col <span class="op">=</span> <span class="va">DIMENSION</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA vs FINANCIERA"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Financiera (%)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggExtra/man/ggMarginal.html">ggMarginal</a></span><span class="op">(</span><span class="va">scatter_plus</span>, type <span class="op">=</span> <span class="st">"histogram"</span>, groupColour <span class="op">=</span> <span class="cn">T</span>,</span>
<span>           groupFill <span class="op">=</span> <span class="cn">T</span>, position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>Con el código anterior, apreciamos cómo se añaden los histogramas de cada variable, RENECO y RENFIN, en los márgenes del gráfico:</p>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-138-1.png" width="672"></div>
<p>Conviene apuntar que el argumento position = “identity” hace que las barras del histograma estén perfectamente alineadas con los datos del gráfico de dispersión, sin ningún tipo de desplazamiento.</p>
<p>Adicionalmente, los diámetros de los puntos de los diversos casos podrían contener también información, haciéndolos proporcionales a una tercera variable. Por ejemplo, podrían ser proporcionales al nivel de solvencia (variable SOLVENCIA). Para ello, ejecutaríamos el código:</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scatter_plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>,</span>
<span>                                                     y <span class="op">=</span> <span class="va">RENFIN</span>,</span>
<span>                                                     col <span class="op">=</span> <span class="va">DIMENSION</span>,</span>
<span>                                                     size <span class="op">=</span> <span class="va">SOLVENCIA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA vs FINANCIERA"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Financiera (%)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggExtra/man/ggMarginal.html">ggMarginal</a></span><span class="op">(</span><span class="va">scatter_plus</span>, type <span class="op">=</span> <span class="st">"histogram"</span>, groupColour <span class="op">=</span> <span class="cn">T</span>,</span>
<span>           groupFill <span class="op">=</span> <span class="cn">T</span>, position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-139-1.png" width="672"></div>
<p>En el código anterior, puede comprobarse que la característica <code>size =</code> sube del bloque de <code>geom</code> al “mapeo” (incluido en el <code>aes</code>), debido a que el diámetro de cada punto ya no va a ser un parámetro fijo, sino que va a depender de la magnitud de la variable SOLVENCIA.</p>
<p>Finalmente, podría ser útil, en algunos gráficos, añadir una etiqueta (<em>label</em>) a cada punto, para <strong>identificar el caso concreto</strong> al que representa. Si bien en esta práctica, el elevado número de casos y el extenso nombre de las empresas hacen poco claro el uso de estas etiquetas, vamos a añadirlas por motivos pedagógicos. Para ello, se añadirá un bloque <code>geom</code> llamado <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>, con una información <code>label =</code> que se hace depender de valores que cambian (en concreto, el nombre de los casos, es decir, de las filas del <em>data frame</em>), por lo que tendrá que integrarse en una característica <code>aes</code>:</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scatter_plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>,</span>
<span>                                                     y <span class="op">=</span> <span class="va">RENFIN</span>,</span>
<span>                                                     col <span class="op">=</span> <span class="va">DIMENSION</span>,</span>
<span>                                                     size <span class="op">=</span> <span class="va">SOLVENCIA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">eolica_100</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA vs FINANCIERA"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Financiera (%)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggExtra/man/ggMarginal.html">ggMarginal</a></span><span class="op">(</span><span class="va">scatter_plus</span>, type <span class="op">=</span> <span class="st">"histogram"</span>, groupColour <span class="op">=</span> <span class="cn">T</span>,</span>
<span>           groupFill <span class="op">=</span> <span class="cn">T</span>, position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-140-1.png" width="672"></div>
<p>Las etiquetas de los casos pueden refinarse algo más mediante la función <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_label_repel()</a></code>, disponible al cargar el paquete <a href="https://ggrepel.slowkow.com/">ggrepel</a>:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/">ggrepel</a></span><span class="op">)</span></span>
<span><span class="va">scatter_plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eolica_100</span>, map <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RENECO</span>,</span>
<span>                                                     y <span class="op">=</span> <span class="va">RENFIN</span>,</span>
<span>                                                     col <span class="op">=</span> <span class="va">DIMENSION</span>,</span>
<span>                                                     size <span class="op">=</span> <span class="va">SOLVENCIA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">eolica_100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"RENTABILIDAD ECONÓMICA vs FINANCIERA"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"100 empresas eólicas"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Rentabilidad Económica (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Rentabilidad Financiera (%)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggExtra/man/ggMarginal.html">ggMarginal</a></span><span class="op">(</span><span class="va">scatter_plus</span>, type <span class="op">=</span> <span class="st">"histogram"</span>, groupColour <span class="op">=</span> <span class="cn">T</span>,</span>
<span>           groupFill <span class="op">=</span> <span class="cn">T</span>,</span>
<span>           position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="RstarS_files/figure-html/unnamed-chunk-141-1.png" width="672"></div>
<p>La ventaja de este gráfico, como se puede apreciar, es que se omiten las etiquetas superpuestas, si bien existe el riesgo de que se omitan una gran cantidad de estas.</p>
</div>
</div>
<div id="materiales-para-realizar-las-prácticas-del-capítulo.-1" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Materiales para realizar las prácticas del capítulo.<a class="anchor" aria-label="anchor" href="#materiales-para-realizar-las-pr%C3%A1cticas-del-cap%C3%ADtulo.-1"><i class="fas fa-link"></i></a>
</h2>
<p>En esta sección se muestran los links de acceso a los diferentes materiales (scripts, datos…) necesarios para llevar a cabo los contenidos prácticos del capítulo.</p>
<p><strong>Datos (en formato Microsoft (R) Excel (R)):</strong></p>
<ul>
<li>eolica_100.xlsx (<a href="https://docs.google.com/spreadsheets/d/1Up5ZWR57rgIkmYJcr2Pek6kUdG_yd4vu/edit?usp=drive_link&amp;ouid=115375878280465826079&amp;rtpof=true&amp;sd=true">obtener aquí</a>)</li>
</ul>
<p><strong>Scripts:</strong></p>
<ul>
<li>explora_ggplot2.R (<a href="https://drive.google.com/file/d/1R0qYnrjcel4SOH9lVI1_qkccKYXBLLDC/view?usp=sharing">obtener aquí</a>)</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="almacenando-y-manipulando-datos..html"><span class="header-section-number">2</span> Almacenando y manipulando datos.</a></div>
<div class="next"><a href="estad%C3%ADstica-descriptiva..html"><span class="header-section-number">4</span> Estadística descriptiva.</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#gr%C3%A1ficos."><span class="header-section-number">3</span> Gráficos.</a></li>
<li><a class="nav-link" href="#tidyverse-para-gr%C3%A1ficos-ggplot2."><span class="header-section-number">3.1</span> Tidyverse para gráficos: ggplot2.</a></li>
<li>
<a class="nav-link" href="#gr%C3%A1ficos-de-una-variable-histogramas-gr%C3%A1ficos-de-densidad-gr%C3%A1ficos-de-caja-o-boxplots."><span class="header-section-number">3.2</span> Gráficos de una variable: histogramas, gráficos de densidad, gráficos de caja o boxplots.</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#histograma."><span class="header-section-number">3.2.1</span> Histograma.</a></li>
<li><a class="nav-link" href="#gr%C3%A1fico-de-densidad."><span class="header-section-number">3.2.2</span> Gráfico de densidad.</a></li>
<li><a class="nav-link" href="#gr%C3%A1fico-de-caja-o-box-plot."><span class="header-section-number">3.2.3</span> Gráfico de caja o Box-Plot.</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#gr%C3%A1ficos-de-dos-variables."><span class="header-section-number">3.3</span> Gráficos de dos variables.</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#gr%C3%A1fico-de-dispersi%C3%B3n-o-scatterplot."><span class="header-section-number">3.3.1</span> Gráfico de dispersión o scatterplot.</a></li></ul>
</li>
<li><a class="nav-link" href="#materiales-para-realizar-las-pr%C3%A1cticas-del-cap%C3%ADtulo.-1"><span class="header-section-number">3.4</span> Materiales para realizar las prácticas del capítulo.</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R-Stars: La Guía</strong>" was written by Miguel-Ángel Tarancón. It was last built on 2025-09-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
