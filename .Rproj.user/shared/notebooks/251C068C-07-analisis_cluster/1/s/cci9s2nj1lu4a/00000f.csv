"0","library (patchwork)  "
"0",""
"0","# Función para crear agrupaciones de 2x2 con espacios en blanco si es necesario"
"0","  create_patchwork <- function(plot_list) {   "
"0","    n <- length(plot_list)   "
"0","    full_rows <- n %/% 4   "
"0","    remaining <- n %% 4      "
"0","    patchworks <- list()"
"0","    "
"0","    # Crear agrupaciones completas de 2x2   "
"0","    "
"0","      for (i in seq(1, full_rows * 4, by = 4)) {"
"0","        patchworks <- c(patchworks,"
"0","                        list((plot_list[[i]] | plot_list[[i+1]]) /"
"0","                             (plot_list[[i+2]] | plot_list[[i+3]])))   }"
"0","    # Crear la última agrupación con espacios en blanco si es necesario   "
"0","      if (remaining > 0) {     "
"0","        last_plots <- plot_list[(full_rows * 4 + 1):n]     "
"0","        empty_plots <- lapply(1:(4 - remaining), function(x) ggplot() +"
"0","                                theme_void())"
"0","        last_patchwork <- do.call(patchwork::wrap_plots,"
"0","                                  c(last_plots, empty_plots))"
"0","        patchworks <- c(patchworks, list(last_patchwork))   }"
"0","    return(patchworks) } "
