"0","tipo_output <- c(""html"") # pdf, html, docx"
"0","knitr::opts_knit$set(rmarkdown.pandoc.to = tipo_output)"
"0","  "
"0","# Bucle para generar gráficos y análisis"
"0","    for (i in seq_along(variables)) {"
"0","         variable <- variables[i]"
"0",""
"0","    # Crear el gráfico"
"0","      p <- ggplot(data = originales_so,"
"0","                  aes_string(x = ""whatcluster_k"","
"0","                             y = variable,"
"0","                             fill = ""whatcluster_k"")) +"
"0","           geom_boxplot(outlier.shape = NA) +"
"0","           stat_summary(fun = ""mean"","
"0","                        geom = ""point"","
"0","                        size = 3,"
"0","                        col = ""red"") +"
"0","           stat_summary(fun = ""mean"","
"0","                        geom = ""line"","
"0","                        col = ""red"","
"0","                        aes(group = TRUE)) +   "
"0","           geom_jitter(width = 0.1,"
"0","                       size = 1,"
"0","                       col = ""red"","
"0","                       alpha = 0.40) +"
"0","           ggtitle(paste(variable, "". Comparación de grupos.""),"
"0","                   subtitle = ""Empresas eólicas"") +"
"0","           ylab(""Valor"")"
"0","  "
"0","    # Almacenar el gráfico en la lista"
"0","      graficos_kw[[i]] <- p"
"0","  "
"0","    # Realizar el análisis de Kruskal-Wallis"
"0","      datos_kmc <- kruskalmc(as.formula(paste(variable, ""~ whatcluster_k"")),"
"0","                             data = originales_so)"
"0","      if (knitr::opts_knit$get(""rmarkdown.pandoc.to"") == ""html"") {"
"0","      tabla <- datos_kmc$dif.com %>%"
"0","               kable(caption = paste(""k-medias. Diferencias de Centroides"","
"0","                                     variable),"
"0","                     col.names = c(""Diferencias centros"","
"0","                                   ""Diferencias críticas"","
"0","                                   ""Significación"")) %>%"
"0","               kable_styling(full_width = F,"
"0","                             bootstrap_options = c(""striped"","
"0","                                                   ""bordered"","
"0","                                                   ""condensed""),"
"0","                             position = ""center"","
"0","                             font_size = 11) %>%"
"0","               row_spec(0, bold = T, align = ""c"") %>%"
"0","               row_spec(1:nrow(datos_kmc$dif.com), bold = F, align = ""c"")"
"0","      }else if (knitr::opts_knit$get(""rmarkdown.pandoc.to"") == ""docx"") {"
"0","        tabla <- datos_kmc$dif.com %>%"
"0","               kable(caption = paste(""k-medias. Diferencias de Centroides"","
"0","                                     variable),"
"0","                     col.names = c(""Diferencias centros"","
"0","                                   ""Diferencias críticas"","
"0","                                   ""Significación""))"
"0","      }        "
"0","    # Almacenar la tabla en la lista"
"0","      tablas_kw[[i]] <- tabla"
"0","    }"
