"0","  # Definir la función de presentación de resultados:  presenta_modelo() #####"
"0",""
"0","    presenta_modelo <- function(modelo) {"
"0",""
"0","    # Lista de piezas"
"0","      modelo_piezas <-list()"
"0","  "
"0","    # Aplicar la función tidy() al modelo"
"0","      resultados <- tidy(modelo)"
"0","  "
"0","    # Seleccionar las columnas deseadas"
"0","      resultados <- resultados[, c(""term"","
"0","                                   ""estimate"","
"0","                                   ""std.error"",""statistic"","
"0","                                   ""p.value"")]"
"0","    # Añadir la columna 'stars' según los valores de 'p.value'"
"0","      resultados$stars <- cut(resultados$p.value,"
"0","                            breaks = c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),"
"0","                            labels = c(""***"", ""**"", ""*"", ""."", "" ""),"
"0","                            right = FALSE)"
"0","    # formatear los valores de la columna ""estimate"" a 5 decimales"
"0","      resultados$estimate <- formatC(resultados$estimate,"
"0","                                     format = ""f"","
"0","                                     digits = 5)"
"0","  "
"0","    # Crear la tabla con kable"
"0","      tabla1 <- resultados %>%"
"0","        kable(round = knitr.table.format,"
"0","          caption = ""Modelo Lineal"","
"0","          col.names = c(""Variable"", ""Coeficiente"", ""Desv. Típica"","
"0","                        ""Estadístico t"", ""p-valor"", ""Sig.""),"
"0","          digits = 3,"
"0","          align = c(""l"", ""c"", ""c"", ""c"", ""c"", ""c"")) %>%"
"0","        kable_styling(full_width = F,"
"0","                      bootstrap_options = ""striped"","
"0","                                          ""bordered"","
"0","                                          ""condensed"","
"0","                      position = ""center"","
"0","                      font_size = 11)"
"0"," "
"0","      modelo_piezas[[1]] <- tabla1"
"0","  "
"0","    # Aplicar la función glance"
"0","      estadisticos <- glance(modelo)"
"0","      estadisticos <- estadisticos[,c(""r.squared"","
"0","                                      ""adj.r.squared"","
"0","                                      ""sigma"","
"0","                                      ""statistic"","
"0","                                      ""p.value"","
"0","                                      ""AIC"","
"0","                                      ""nobs"")]"
"0","    # Crear la tabla con kable"
"0","      tabla2 <- estadisticos %>%"
"0","        kable(round = knitr.table.format,"
"0","          caption = ""Estadísticos del modelo"","
"0","          col.names = c(""R2"", ""R2 ajustado"", ""Sigma"", ""Estadístico F"","
"0","                        ""p-valor"", ""AIC"", ""num. observaciones""),"
"0","          digits = 3,"
"0","          align = ""c"") %>%"
"0","        kable_styling(full_width = F,"
"0","                      bootstrap_options = ""striped"","
"0","                                          ""bordered"","
"0","                                          ""condensed"","
"0","                      position = ""center"","
"0","                      font_size = 11)"
"0","      "
"0","      modelo_piezas[[2]] <- tabla2  "
"0",""
"0","    # Obtener VIF"
"0","      vif_df <- as.data.frame(vif(modelo))"
"0",""
"0","    # Añadir nombres de filas"
"0","      library(tibble)"
"0","      vif_df <- vif_df %>%"
"0","      rownames_to_column(var = ""Variable"")"
"0","  "
"0","    # Crear tabla con kable"
"0","      tabla3 <- vif_df[,1:2] %>%"
"0","        kable(round = knitr.table.format,"
"0","              caption = ""Factor de inflación de la varianza"","
"0","              col.names = c(""Variable"",""Valor VIF""),"
"0","              digits = 3,"
"0","              align = ""c"") %>%"
"0","        kable_styling(full_width = F,"
"0","                      bootstrap_options = ""striped"","
"0","                                          ""bordered"","
"0","                                          ""condensed"","
"0","                      position = ""center"","
"0","                      font_size = 11)"
"0","      "
"0","      modelo_piezas[[3]] <- tabla3"
"0","  "
"0","    return(modelo_piezas)"
"0","  }"
"0","############################################################################"
"0",""
