"0","## CARACTERIZACIÓN Y COMPOSICIÓN DE GRUPOS."
"0",""
"0","# cortando árbol en grupos"
"0","cl <- cutree(cluster_j, k = ngrupos)"
"0",""
"0","# etiquetas en el orden exacto del dendrograma (izq→der)"
"0","ord_labels <- cluster_j$labels[cluster_j$order]"
"0",""
"0","# posición (1..n) de cada caso según ese orden"
"0","pos <- match(names(cl), ord_labels)"
"0",""
"0","# mapa de id antiguo -> id nuevo (1..ngrupos) según el bloque más a la izquierda"
"0","mins       <- tapply(pos, cl, min)             # posición más a la izq por clúster"
"0","old_order  <- names(sort(mins))                # ids antiguos ordenados izq→der"
"0","map        <- setNames(seq_along(old_order), old_order)"
"0",""
"0","# Formar etiqueta de grupos (factor ""whatcluster"")"
"0","whatcluster_j <- factor(map[as.character(cl)], levels = 1:ngrupos)"
"0","seleccion$whatcluster_j <- whatcluster_j"
